<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <title>Análisis de tweets geolocalizados en Chile</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

    <link rel="stylesheet" href="hito1.css" />

    <!-- Loading mathjax macro -->
    <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
              processEnvironments: true
          },
          // Center justify equations in code and markdown cells. Elsewhere
          // we use CSS to left justify single line equations in code cells.
          displayAlign: 'center',
          "HTML-CSS": {
              styles: {'.MathJax_Display': {"margin": 0}},
              linebreaks: { automatic: true }
          }
      });
    </script>
    <!-- End of mathjax configuration -->
  </head>

  <body>
    <!-- Barra de navegación -->
    <div class="topnav">
      <a href="index.html">Introducción</a>
      <a href="exploracion.html">Exploración de datos</a>
      <a href="propuesta.html">Preguntas y Propuesta</a>
      <a href="exp1.html">Experimento 1 [hito2]</a>
      <a href="exp1hito3.html">Experimento 1 [hito3]</a>
      <a href="exp2.html">Experimento 2</a>
      <a href="exp3.html">Experimento 3</a>
      <a class="active" href="exp4.html">Experimento 4</a>
      <a href="exp5.html">Experimento 5</a>
      <a href="exp6.html">Experimento 6</a>
      <a href="contribucion.html">Contribución</a>
    </div>

    <div tabindex="-1" id="notebook" class="border-box-sizing">
      <div class="container" id="notebook-container">
        <!-- Titulo -->
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h1 id="Titulo">
                ¿Los criterios usados para clasificar los twitts son
                atemporales?<a class="anchor-link" href="#Titulo">&#182;</a>
              </h1>
            </div>
          </div>
        </div>

        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h1 id="Imports">
                Imports<a class="anchor-link" href="#Imports">&#182;</a>
              </h1>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[1]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[2]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="o">!</span>pip3 install spacy
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                ></div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[3]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">import</span> <span class="nn">nltk</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[4]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="o">!</span>spacy download es_core_news_sm
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
Collecting es-core-news-sm==3.1.0
  Downloading https://github.com/explosion/spacy-models/releases/download/es_core_news_sm-3.1.0/es_core_news_sm-3.1.0-py3-none-any.whl (13.7 MB)
✔ Download and installation successful
You can now load the package via spacy.load(&#39;es_core_news_sm&#39;)
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[5]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt&#39;</span><span class="p">)</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stderr output_text"
                >
                  <pre>
[nltk_data]   Package punkt is already up-to-date!
</pre
                  >
                </div>
              </div>

              <div class="output_area">
                <div class="prompt output_prompt">Out[5]:</div>

                <div class="output_text output_subarea output_execute_result">
                  <pre>True</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[6]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stderr output_text"
                >
                  <pre>
[nltk_data]   Package stopwords is already up-to-date!
</pre
                  >
                </div>
              </div>

              <div class="output_area">
                <div class="prompt output_prompt">Out[6]:</div>

                <div class="output_text output_subarea output_execute_result">
                  <pre>True</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[7]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>  
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">FeatureUnion</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[8]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">SnowballStemmer</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>

<span class="kn">from</span> <span class="nn">spacy.lang.es.stop_words</span> <span class="kn">import</span> <span class="n">STOP_WORDS</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h1 id="Carga-de-datos">
                Carga de datos<a class="anchor-link" href="#Carga-de-datos"
                  >&#182;</a
                >
              </h1>
              <p>
                Dado que los datos se encontraban en diferentes archivos .csv,
                se cargaron todos juntos en un mismo dataframe con el siguiente
                código:
              </p>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[9]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># Carga del dataframe</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tweets_chile_geolocalizados2.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idTweet&#39;</span><span class="p">,</span> <span class="s1">&#39;idUser&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span><span class="s1">&#39;tweet&#39;</span><span class="p">,</span><span class="s1">&#39;latitud&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <p>Obteniendo el siguiente resultado:</p>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[10]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">data</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt output_prompt">Out[10]:</div>

                <div
                  class="
                    output_html
                    rendered_html
                    output_subarea output_execute_result
                  "
                >
                  <div>
                    <style scoped>
                      .dataframe tbody tr th:only-of-type {
                        vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                        vertical-align: top;
                      }

                      .dataframe thead th {
                        text-align: right;
                      }
                    </style>
                    <table border="1" class="dataframe">
                      <thead>
                        <tr style="text-align: right">
                          <th></th>
                          <th>idTweet</th>
                          <th>idUser</th>
                          <th>created_at</th>
                          <th>tweet</th>
                          <th>latitud</th>
                          <th>longitude</th>
                          <th>class</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>351490338654916608</td>
                          <td>73787280</td>
                          <td>2013-07-01 00:00:01</td>
                          <td>
                            “@naraback: Si bachelet fuera flaca, con qué l...
                          </td>
                          <td>-33.2615</td>
                          <td>-70.6297</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>351490339107901442</td>
                          <td>325370754</td>
                          <td>2013-07-01 00:00:01</td>
                          <td>
                            Si gana Longueira, la mínima posibilidad de ga...
                          </td>
                          <td>-32.9544</td>
                          <td>-71.5317</td>
                          <td>centro</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>351490342996033536</td>
                          <td>96595015</td>
                          <td>2013-07-01 00:00:02</td>
                          <td>BRASIL CAMPEÓN MUNDIAL !!!! Gana a España 3-0</td>
                          <td>-33.4395</td>
                          <td>-70.6026</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>351490358078742532</td>
                          <td>172096924</td>
                          <td>2013-07-01 00:00:06</td>
                          <td>
                            Denuevo la Bachelet... porque lo chilenos no a...
                          </td>
                          <td>-33.4133</td>
                          <td>-70.5777</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>351490399686230016</td>
                          <td>115070990</td>
                          <td>2013-07-01 00:00:16</td>
                          <td>
                            Esta que arde la cosa entre Allamand y Longuei...
                          </td>
                          <td>-33.4872</td>
                          <td>-70.6531</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>...</th>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                        </tr>
                        <tr>
                          <th>9752490</th>
                          <td>870066396109078528</td>
                          <td>123745861</td>
                          <td>2017-05-31 23:56:08</td>
                          <td>
                            Mi doctor y su mala idea de tener su consulta ...
                          </td>
                          <td>-33.4093</td>
                          <td>-70.5732</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>9752491</th>
                          <td>870066468024725505</td>
                          <td>119277399</td>
                          <td>2017-05-31 23:56:25</td>
                          <td>
                            Once romántica solitaria.. llenándome de energ...
                          </td>
                          <td>-33.4374</td>
                          <td>-70.6334</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>9752492</th>
                          <td>870066525520224256</td>
                          <td>126125055</td>
                          <td>2017-05-31 23:56:39</td>
                          <td>
                            Un hermoso tejido que me hizo mi madre para mi...
                          </td>
                          <td>-33.6081</td>
                          <td>-70.6952</td>
                          <td>RM</td>
                        </tr>
                        <tr>
                          <th>9752493</th>
                          <td>870066808547454976</td>
                          <td>68747705</td>
                          <td>2017-05-31 23:57:46</td>
                          <td>
                            Holis!!! kattta_monroy 🙈🙊 #quemaneradereirnos ...
                          </td>
                          <td>-38.4167</td>
                          <td>-72.3833</td>
                          <td>sur</td>
                        </tr>
                        <tr>
                          <th>9752494</th>
                          <td>870067310605869056</td>
                          <td>372267677</td>
                          <td>2017-05-31 23:59:46</td>
                          <td>
                            Después de un largo día de prensa en Stgo junt...
                          </td>
                          <td>-33.4296</td>
                          <td>-70.6210</td>
                          <td>RM</td>
                        </tr>
                      </tbody>
                    </table>
                    <p>9752495 rows × 7 columns</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h1 id="Preprocesamiento-de-datos">
                Preprocesamiento de datos<a
                  class="anchor-link"
                  href="#Preprocesamiento-de-datos"
                  >&#182;</a
                >
              </h1>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[11]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="k">def</span> <span class="nf">agregar_utc_chile</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

  <span class="n">cambios_hora</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> 
                  <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
  <span class="n">utc</span> <span class="o">=</span> <span class="mi">3</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cambios_hora</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">inferior</span> <span class="o">=</span> <span class="n">cambios_hora</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">superior</span> <span class="o">=</span> <span class="n">cambios_hora</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">superior</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">inferior</span><span class="p">),</span> <span class="s1">&#39;UTC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utc</span>

    <span class="k">if</span> <span class="n">utc</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
      <span class="n">utc</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">utc</span> <span class="o">=</span> <span class="mi">3</span>
  
  <span class="k">return</span> <span class="n">df</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h2 id="Correcci&#243;n-fechas">
                Correcci&#243;n fechas<a
                  class="anchor-link"
                  href="#Correcci&#243;n-fechas"
                  >&#182;</a
                >
              </h2>
              <p>
                Para dar solución al problema mencionado en el apartado
                anterior, se descompuso el atributo 'created_at' por los
                atributos 'year', 'hour' y 'weekday'.
              </p>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[12]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># Parseo de las fechas, las que estaban en formato de String y se pasaron a formate datetime.datetime (yy-mm-dd hh:mm:ss).</span>

<span class="c1"># Es una operación optimizable.</span>

<span class="n">fechas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">fechas_transformadas</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fechas</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">created_at</span> <span class="o">=</span> <span class="n">fechas_transformadas</span><span class="p">)</span>
<span class="c1"># Se aplica un mapeo al arreglo obtenido de la columna &#39;created_at&#39; en la celda anterior para obtener 3 arreglos:</span>
<span class="c1"># los años, las horas y los dias de la semana correspondientes a cada fecha del arreglo.</span>
<span class="n">años</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fechas_transformadas</span><span class="p">]</span>
<span class="n">hora</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">hour</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fechas_transformadas</span><span class="p">]</span>
<span class="n">dia_semana</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">day_name</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">weekday</span><span class="p">()]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fechas_transformadas</span><span class="p">]</span>

<span class="c1"># Se borran del ambiente ya que no se van a necesitar de nuevo</span>
<span class="k">del</span><span class="p">(</span><span class="n">fechas_transformadas</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">fechas</span><span class="p">)</span>

<span class="c1"># Se crean nuevos atributos en el dataset inicial para incluir como columnas a los arreglos obtenidos de la columna </span>
<span class="c1"># &#39;created_at&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">años</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">hour</span> <span class="o">=</span> <span class="n">hora</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">dia_semana</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">agregar_utc_chile</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Se borran del ambiente ya que no se van a necesitar de nuevo</span>
<span class="k">del</span><span class="p">(</span><span class="n">años</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">hora</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">dia_semana</span><span class="p">)</span>


<span class="n">tweets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;tweet&#39;</span><span class="p">])</span>
<span class="n">largo_mensajes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tw</span><span class="p">))</span> <span class="k">for</span> <span class="n">tw</span> <span class="ow">in</span> <span class="n">tweets</span><span class="p">]</span>

<span class="c1"># Se añade el largo de cada tweet como un atributo del dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">largo_tweet</span> <span class="o">=</span> <span class="n">largo_mensajes</span><span class="p">)</span>

<span class="c1"># Se borran del ambiente ya que no se van a necesitar de nuevo</span>
<span class="k">del</span><span class="p">(</span><span class="n">largo_mensajes</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[13]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">data</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt output_prompt">Out[13]:</div>

                <div
                  class="
                    output_html
                    rendered_html
                    output_subarea output_execute_result
                  "
                >
                  <div>
                    <style scoped>
                      .dataframe tbody tr th:only-of-type {
                        vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                        vertical-align: top;
                      }

                      .dataframe thead th {
                        text-align: right;
                      }
                    </style>
                    <table border="1" class="dataframe">
                      <thead>
                        <tr style="text-align: right">
                          <th></th>
                          <th>idTweet</th>
                          <th>idUser</th>
                          <th>created_at</th>
                          <th>tweet</th>
                          <th>latitud</th>
                          <th>longitude</th>
                          <th>class</th>
                          <th>year</th>
                          <th>hour</th>
                          <th>weekday</th>
                          <th>UTC</th>
                          <th>largo_tweet</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>0</th>
                          <td>351490338654916608</td>
                          <td>73787280</td>
                          <td>2013-07-01 00:00:01</td>
                          <td>
                            “@naraback: Si bachelet fuera flaca, con qué l...
                          </td>
                          <td>-33.2615</td>
                          <td>-70.6297</td>
                          <td>RM</td>
                          <td>2013</td>
                          <td>0</td>
                          <td>Monday</td>
                          <td>4</td>
                          <td>80</td>
                        </tr>
                        <tr>
                          <th>1</th>
                          <td>351490339107901442</td>
                          <td>325370754</td>
                          <td>2013-07-01 00:00:01</td>
                          <td>
                            Si gana Longueira, la mínima posibilidad de ga...
                          </td>
                          <td>-32.9544</td>
                          <td>-71.5317</td>
                          <td>centro</td>
                          <td>2013</td>
                          <td>0</td>
                          <td>Monday</td>
                          <td>4</td>
                          <td>90</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>351490342996033536</td>
                          <td>96595015</td>
                          <td>2013-07-01 00:00:02</td>
                          <td>BRASIL CAMPEÓN MUNDIAL !!!! Gana a España 3-0</td>
                          <td>-33.4395</td>
                          <td>-70.6026</td>
                          <td>RM</td>
                          <td>2013</td>
                          <td>0</td>
                          <td>Monday</td>
                          <td>4</td>
                          <td>45</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>351490358078742532</td>
                          <td>172096924</td>
                          <td>2013-07-01 00:00:06</td>
                          <td>
                            Denuevo la Bachelet... porque lo chilenos no a...
                          </td>
                          <td>-33.4133</td>
                          <td>-70.5777</td>
                          <td>RM</td>
                          <td>2013</td>
                          <td>0</td>
                          <td>Monday</td>
                          <td>4</td>
                          <td>56</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>351490399686230016</td>
                          <td>115070990</td>
                          <td>2013-07-01 00:00:16</td>
                          <td>
                            Esta que arde la cosa entre Allamand y Longuei...
                          </td>
                          <td>-33.4872</td>
                          <td>-70.6531</td>
                          <td>RM</td>
                          <td>2013</td>
                          <td>0</td>
                          <td>Monday</td>
                          <td>4</td>
                          <td>51</td>
                        </tr>
                        <tr>
                          <th>...</th>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                          <td>...</td>
                        </tr>
                        <tr>
                          <th>9752490</th>
                          <td>870066396109078528</td>
                          <td>123745861</td>
                          <td>2017-05-31 23:56:08</td>
                          <td>
                            Mi doctor y su mala idea de tener su consulta ...
                          </td>
                          <td>-33.4093</td>
                          <td>-70.5732</td>
                          <td>RM</td>
                          <td>2017</td>
                          <td>23</td>
                          <td>Wednesday</td>
                          <td>4</td>
                          <td>137</td>
                        </tr>
                        <tr>
                          <th>9752491</th>
                          <td>870066468024725505</td>
                          <td>119277399</td>
                          <td>2017-05-31 23:56:25</td>
                          <td>
                            Once romántica solitaria.. llenándome de energ...
                          </td>
                          <td>-33.4374</td>
                          <td>-70.6334</td>
                          <td>RM</td>
                          <td>2017</td>
                          <td>23</td>
                          <td>Wednesday</td>
                          <td>4</td>
                          <td>127</td>
                        </tr>
                        <tr>
                          <th>9752492</th>
                          <td>870066525520224256</td>
                          <td>126125055</td>
                          <td>2017-05-31 23:56:39</td>
                          <td>
                            Un hermoso tejido que me hizo mi madre para mi...
                          </td>
                          <td>-33.6081</td>
                          <td>-70.6952</td>
                          <td>RM</td>
                          <td>2017</td>
                          <td>23</td>
                          <td>Wednesday</td>
                          <td>4</td>
                          <td>92</td>
                        </tr>
                        <tr>
                          <th>9752493</th>
                          <td>870066808547454976</td>
                          <td>68747705</td>
                          <td>2017-05-31 23:57:46</td>
                          <td>
                            Holis!!! kattta_monroy 🙈🙊 #quemaneradereirnos ...
                          </td>
                          <td>-38.4167</td>
                          <td>-72.3833</td>
                          <td>sur</td>
                          <td>2017</td>
                          <td>23</td>
                          <td>Wednesday</td>
                          <td>4</td>
                          <td>90</td>
                        </tr>
                        <tr>
                          <th>9752494</th>
                          <td>870067310605869056</td>
                          <td>372267677</td>
                          <td>2017-05-31 23:59:46</td>
                          <td>
                            Después de un largo día de prensa en Stgo junt...
                          </td>
                          <td>-33.4296</td>
                          <td>-70.6210</td>
                          <td>RM</td>
                          <td>2017</td>
                          <td>23</td>
                          <td>Wednesday</td>
                          <td>4</td>
                          <td>121</td>
                        </tr>
                      </tbody>
                    </table>
                    <p>9752495 rows × 12 columns</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h1 id="Inicio-de-experimentos">
                Inicio de experimentos<a
                  class="anchor-link"
                  href="#Inicio-de-experimentos"
                  >&#182;</a
                >
              </h1>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[14]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># Agrupamos por año de publicación de los tweets</span>
<span class="n">años</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2013</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2014</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2015</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2016</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2017</span><span class="p">]]</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[15]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;es_core_news_sm&quot;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ner&#39;</span><span class="p">,</span> <span class="s1">&#39;parser&#39;</span><span class="p">,</span> <span class="s1">&#39;tagger&#39;</span><span class="p">])</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[16]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">pipelines</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">años</span><span class="p">)):</span>
    

    <span class="c1"># Definimos el vectorizador para convertir el texto a BoW:</span>
    <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>  

    <span class="c1"># Definimos el clasificador que usaremos.</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>   

    <span class="c1"># Creamos el pipeline</span>
    <span class="n">text_clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">clf</span><span class="p">)])</span>
    
    <span class="n">pipelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_clf</span><span class="p">)</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h3
                id="Subsampling-para-que-est&#233;-la-misma-cantidad-de-elementos-por-clase,-generando-un-sampling-por-a&#241;o"
              >
                Subsampling para que est&#233; la misma cantidad de elementos
                por clase, generando un sampling por a&#241;o<a
                  class="anchor-link"
                  href="#Subsampling-para-que-est&#233;-la-misma-cantidad-de-elementos-por-clase,-generando-un-sampling-por-a&#241;o"
                  >&#182;</a
                >
              </h3>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[17]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">min_sample</span> <span class="o">=</span> <span class="mi">99999999</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">min_sample</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;norte&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_sample</span><span class="p">)</span>
    <span class="n">min_sample</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;centro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_sample</span><span class="p">)</span>
    <span class="n">min_sample</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_sample</span><span class="p">)</span>
    <span class="n">min_sample</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_sample</span><span class="p">)</span>
<span class="n">min_sample</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt output_prompt">Out[17]:</div>

                <div class="output_text output_subarea output_execute_result">
                  <pre>24688</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[18]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">y_pred_años</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_test_años</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">años</span><span class="p">)):</span>

    <span class="n">data_año</span> <span class="o">=</span> <span class="n">años</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">NUM_SAMPLES</span> <span class="o">=</span> <span class="n">min_sample</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">data_año</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">g</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">NUM_SAMPLES</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
            <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">del</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="n">tweets_zona</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;idTweet&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;class&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">tweets_zona</span> <span class="o">=</span> <span class="n">tweets_zona</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;idTweet&#39;</span><span class="p">:</span> <span class="s1">&#39;Frecuencia&#39;</span><span class="p">})</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">tweet</span><span class="p">,</span>
                                                      <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span>
                                                      <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span>
                                                      <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">y_test_años</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
    
    <span class="c1"># Entrenamos nuestro pipeline</span>
    <span class="n">pipelines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">y_pred_años</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pipelines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h3
                id="Vemos-el-desempe&#241;o-de-cada-clasificador-con-datos-del-mismo-a&#241;o"
              >
                Vemos el desempe&#241;o de cada clasificador con datos del mismo
                a&#241;o<a
                  class="anchor-link"
                  href="#Vemos-el-desempe&#241;o-de-cada-clasificador-con-datos-del-mismo-a&#241;o"
                  >&#182;</a
                >
              </h3>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="A&#241;o-2013">
                A&#241;o 2013<a class="anchor-link" href="#A&#241;o-2013"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[19]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
[[3487 1546 1979 1126]
 [1661 3367 1908 1221]
 [1400 1410 4316  935]
 [1378 1304 1621 3930]]
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[20]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># usando el classification report:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.44      0.43      0.43      8138
      centro       0.44      0.41      0.43      8157
       norte       0.44      0.54      0.48      8061
         sur       0.54      0.48      0.51      8233

    accuracy                           0.46     32589
   macro avg       0.47      0.46      0.46     32589
weighted avg       0.47      0.46      0.46     32589

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="A&#241;o-2014">
                A&#241;o 2014<a class="anchor-link" href="#A&#241;o-2014"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[21]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
[[3433 1600 1975 1130]
 [1632 3199 2113 1213]
 [1401 1404 4304  952]
 [1358 1407 1785 3683]]
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[22]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># usando el classification report:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.44      0.42      0.43      8138
      centro       0.42      0.39      0.41      8157
       norte       0.42      0.53      0.47      8061
         sur       0.53      0.45      0.48      8233

    accuracy                           0.45     32589
   macro avg       0.45      0.45      0.45     32589
weighted avg       0.45      0.45      0.45     32589

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="A&#241;o-2015">
                A&#241;o 2015<a class="anchor-link" href="#A&#241;o-2015"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[23]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
[[4046 1406 1864  822]
 [1078 4160 1952  967]
 [ 843 1204 5267  747]
 [ 776 1287 1612 4558]]
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[24]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># usando el classification report:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.60      0.50      0.54      8138
      centro       0.52      0.51      0.51      8157
       norte       0.49      0.65      0.56      8061
         sur       0.64      0.55      0.59      8233

    accuracy                           0.55     32589
   macro avg       0.56      0.55      0.55     32589
weighted avg       0.56      0.55      0.55     32589

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="A&#241;o-2016">
                A&#241;o 2016<a class="anchor-link" href="#A&#241;o-2016"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[25]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
[[5567  697 1240  634]
 [ 652 5583 1217  705]
 [ 494  549 6512  506]
 [ 459  513  875 6386]]
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[26]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># usando el classification report:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.78      0.68      0.73      8138
      centro       0.76      0.68      0.72      8157
       norte       0.66      0.81      0.73      8061
         sur       0.78      0.78      0.78      8233

    accuracy                           0.74     32589
   macro avg       0.74      0.74      0.74     32589
weighted avg       0.74      0.74      0.74     32589

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="A&#241;o-2017">
                A&#241;o 2017<a class="anchor-link" href="#A&#241;o-2017"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[27]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
[[5524  497  768 1349]
 [ 358 5735  742 1322]
 [ 328  327 6547  859]
 [ 253  398  588 6994]]
</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[28]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># usando el classification report:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_años</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">y_pred_años</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.85      0.68      0.76      8138
      centro       0.82      0.70      0.76      8157
       norte       0.76      0.81      0.78      8061
         sur       0.66      0.85      0.75      8233

    accuracy                           0.76     32589
   macro avg       0.78      0.76      0.76     32589
weighted avg       0.77      0.76      0.76     32589

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h3
                id="Subsampling-sobre-todo-el-dataset-para-comparar-desempe&#241;os-en-base-a-un-mismo-test"
              >
                Subsampling sobre todo el dataset para comparar desempe&#241;os
                en base a un mismo test<a
                  class="anchor-link"
                  href="#Subsampling-sobre-todo-el-dataset-para-comparar-desempe&#241;os-en-base-a-un-mismo-test"
                  >&#182;</a
                >
              </h3>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[29]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">NUM_SAMPLES</span> <span class="o">=</span> <span class="mi">845617</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">g</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">NUM_SAMPLES</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
        <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">del</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="n">tweets_zona</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;idTweet&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;class&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">tweets_zona</span> <span class="o">=</span> <span class="n">tweets_zona</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;idTweet&#39;</span><span class="p">:</span> <span class="s1">&#39;Frecuencia&#39;</span><span class="p">})</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">tweet</span><span class="p">,</span>
                                                  <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span>
                                                  <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span>
                                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h3
                id="Se-comparan-los-desempe&#241;os-de-cada-clasificador-con-el-dataset-y_test"
              >
                Se comparan los desempe&#241;os de cada clasificador con el
                dataset y_test<a
                  class="anchor-link"
                  href="#Se-comparan-los-desempe&#241;os-de-cada-clasificador-con-el-dataset-y_test"
                  >&#182;</a
                >
              </h3>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="Clasificador-a&#241;o-2013">
                Clasificador a&#241;o 2013<a
                  class="anchor-link"
                  href="#Clasificador-a&#241;o-2013"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[30]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.46      0.47      0.46    278874
      centro       0.46      0.43      0.44    279467
       norte       0.45      0.54      0.50    278312
         sur       0.57      0.48      0.52    279562

    accuracy                           0.48   1116215
   macro avg       0.48      0.48      0.48   1116215
weighted avg       0.48      0.48      0.48   1116215

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="Clasificador-a&#241;o-2014">
                Clasificador a&#241;o 2014<a
                  class="anchor-link"
                  href="#Clasificador-a&#241;o-2014"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[31]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.47      0.47      0.47    278874
      centro       0.46      0.43      0.44    279467
       norte       0.46      0.54      0.50    278312
         sur       0.56      0.50      0.53    279562

    accuracy                           0.48   1116215
   macro avg       0.49      0.48      0.48   1116215
weighted avg       0.49      0.48      0.48   1116215

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="Clasificador-a&#241;o-2015">
                Clasificador a&#241;o 2015<a
                  class="anchor-link"
                  href="#Clasificador-a&#241;o-2015"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[32]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.52      0.39      0.45    278874
      centro       0.44      0.46      0.45    279467
       norte       0.43      0.58      0.49    278312
         sur       0.57      0.48      0.52    279562

    accuracy                           0.48   1116215
   macro avg       0.49      0.48      0.48   1116215
weighted avg       0.49      0.48      0.48   1116215

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="Clasificador-a&#241;o-2016">
                Clasificador a&#241;o 2016<a
                  class="anchor-link"
                  href="#Clasificador-a&#241;o-2016"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[33]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.50      0.38      0.44    278874
      centro       0.47      0.40      0.43    279467
       norte       0.42      0.55      0.48    278312
         sur       0.48      0.53      0.50    279562

    accuracy                           0.46   1116215
   macro avg       0.47      0.46      0.46   1116215
weighted avg       0.47      0.46      0.46   1116215

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h4 id="Clasificador-a&#241;o-2017">
                Clasificador a&#241;o 2017<a
                  class="anchor-link"
                  href="#Clasificador-a&#241;o-2017"
                  >&#182;</a
                >
              </h4>
            </div>
          </div>
        </div>
        <div class="cell border-box-sizing code_cell rendered">
          <div class="input">
            <div class="prompt input_prompt">In&nbsp;[34]:</div>
            <div class="inner_cell">
              <div class="input_area">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre>
                </div>
              </div>
            </div>
          </div>

          <div class="output_wrapper">
            <div class="output">
              <div class="output_area">
                <div class="prompt"></div>

                <div
                  class="output_subarea output_stream output_stdout output_text"
                >
                  <pre>
              precision    recall  f1-score   support

          RM       0.58      0.28      0.38    278874
      centro       0.50      0.33      0.40    279467
       norte       0.48      0.42      0.45    278312
         sur       0.36      0.71      0.48    279562

    accuracy                           0.44   1116215
   macro avg       0.48      0.44      0.42   1116215
weighted avg       0.48      0.44      0.42   1116215

</pre
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="cell border-box-sizing text_cell rendered">
          <div class="prompt input_prompt"></div>
          <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
              <h2>Conclusión</h2>
              <p>
                En base a lo experimentado, se puede ver como los clasificadores
                de los años 2013, 2014 y 2015 tienen un desempeño peor que el
                clasificador original (del experimento 1). El clasificador del
                año 2016 tiene un desempeño similar al original. Finalmente se
                puede ver como el clasificador del año 2017 tiene un mejor
                desempeño que el clasificador original. Esta primera comparación
                entre los clasificadores indica que en el año 2017 las distintas
                zonas geográficas están más marcadas en cada twitt, permitiendo
                una mejor clasificación de texto para las publicaciones de ese
                mismo año.
              </p>
              <p>
                Ahora se procederá a analizar el desempeño de cada clasificador
                entrenado con twitts de un solo año frente a un dataset de
                prueba que contiene twitts de todos los años. Se puede ver como
                todos los desempeños oscilan entre 0.47 y 0.49, distando
                bastante del desempeño original de los clasificadores de los
                años 2016 y 2017. Con esto podemos decir que hay ciertas
                características que tomaron en cuenta estos últimos dos
                clasificadores al entrenarse que no se encuentran en el resto
                del dataset, características que se encuentran presentes solo (o
                con mayor frecuencia) en estos años.
              </p>
              <p>
                Finalmente podemos decir que los criterios usados para
                clasificar los twitts no son atemporales, ya que dependiendo del
                año en el cual se entrene el clasificador se obtiene un
                desempeño distinto, sumado a que este desempeño no se replica
                cuando se clasifican twitts de otros años.
              </p>
            </div>
          </div>
        </div>

        <!-- FIN -->
      </div>
    </div>
    <footer>
      <span>Introducción a la Minería de Datos (CC5206) - Otoño 2021</span>
    </footer>
  </body>
</html>
